<!doctype html><html lang=en><head><title>GSoC 2025: Bfloat16 in LLVM libc - The LLVM Project Blog</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="LLVM Project News and Details from the Trenches"><meta name=author content="Krishna Pandey"><meta property="og:url" content="https://blog.llvm.org/posts/2025-09-10-bfloat16-in-llvm-libc/"><meta property="og:site_name" content="The LLVM Project Blog"><meta property="og:title" content="GSoC 2025: Bfloat16 in LLVM libc"><meta property="og:description" content="Introduction BFloat16 is a 16-bit floating-point format, introduced by Google and standardized in C++23 as std::bfloat16_t. It uses 1 sign bit, 8 exponent bits (the same as float), and 7 mantissa bits."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-29T00:00:00+00:00"><meta property="article:modified_time" content="2025-09-29T00:00:00+00:00"><meta property="article:tag" content="GSoC"><meta property="article:tag" content="Libc"><meta property="article:tag" content="Math"><meta property="article:tag" content="C++23"><meta name=twitter:card content="summary"><meta name=twitter:title content="GSoC 2025: Bfloat16 in LLVM libc"><meta name=twitter:description content="Introduction BFloat16 is a 16-bit floating-point format, introduced by Google and standardized in C++23 as std::bfloat16_t. It uses 1 sign bit, 8 exponent bits (the same as float), and 7 mantissa bits."><meta name=generator content="Hugo 0.128.0"><link rel=stylesheet href=https://blog.llvm.org/css/normalize.min.css><link rel=stylesheet href=https://blog.llvm.org/fontawesome/css/all.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda"><link rel=stylesheet type=text/css href=https://blog.llvm.org/css/styles.css></head><body><div id=container><header><h1><a href=https://blog.llvm.org/>The LLVM Project Blog</a></h1><ul id=social-media><li><a href=https://www.facebook.com/llvmorg title=Facebook><i class="fab fa-facebook fa-lg"></i></a></li><li><a href=https://github.com/llvm title=GitHub><i class="fab fa-github fa-lg"></i></a></li><li><a href=https://twitter.com/llvmorg title=Twitter><i class="fab fa-twitter fa-lg"></i></a></li><li><a href=https://www.youtube.com/c/LLVMPROJ title=Youtube><i class="fab fa-youtube fa-lg"></i></a></li></ul><p><em>LLVM Project News and Details from the Trenches</em></p></header><nav><ul><li><a href=https://blog.llvm.org/about><i class="fa-li fa fa-lg"></i><span>About</span></a></li><li><a href=https://blog.llvm.org/posts><i class="fa-li fa fa-lg"></i><span>Posts</span></a></li><li><a href=https://blog.llvm.org/tags><i class="fa-li fa fa-lg"></i><span>Tags</span></a></li><li><a href=https://llvm.org/><i class="fa-li fa fa-lg"></i><span>llvm.org</span></a></li></ul></nav><main><article><h1>GSoC 2025: Bfloat16 in LLVM libc</h1><aside><ul><li>By Krishna Pandey</li><li><time class=post-date datetime=2025-09-29T00:00:00Z>Sep 29, 2025</time></li><li><em><a href=https://blog.llvm.org/tags/gsoc>#GSoC</a>
,
<a href=https://blog.llvm.org/tags/libc>#libc</a>
,
<a href=https://blog.llvm.org/tags/math>#math</a>
,
<a href=https://blog.llvm.org/tags/c++23>#c++23</a></em></li><li>3 minute read</li></ul></aside><h2 id=introduction>Introduction</h2><p>BFloat16 is a 16-bit floating-point format, introduced by Google and standardized in C++23 as <code>std::bfloat16_t</code>. It uses 1 sign bit, 8 exponent bits (the same as <code>float</code>), and 7 mantissa bits. This configuration allows BFloat16 to represent a much wider dynamic range than IEEE <code>binary16</code> (~3Ã—10^38 values compared to 65,504), though with lower precision. BFloat16 has become popular in AI and machine learning use-cases where it offers significant performance advantages over IEEE <code>binary32</code> while preserving its approximate dynamic range.</p><p>The goal of this project was to implement the BFloat16 type in LLVM libc along with the basic math functions like <code>fabsbf16</code>, <code>fmaxbf16</code>, etc.<br>We also want all functions to be generic (platform-independent) and correctly rounded for all rounding modes.</p><h2 id=what-was-done>What was done</h2><ul><li>BFloat16 type was added to LLVM libc (<code>libc/src/__support/FPUtil/bfloat16.h</code>) <a href=https://github.com/llvm/llvm-project/pull/144463>#144463</a>.</li><li>All 70 expected basic math functions for <code>bfloat16</code> were implemented, using a generic approach that supports all libc supported architectures (ARM, RISC-V, GPUs, x86, Darwin) (see table below).</li><li>Implemented two additional basic math functions: <code>iscanonicalbf16</code> and <code>issignalingbf16</code>.</li><li>Implemented higher math functions: <code>sqrtbf16</code> <a href=https://github.com/llvm/llvm-project/pull/156654>#156654</a> and <code>log_bf16</code> <a href=https://github.com/llvm/llvm-project/pull/157811>#157811</a> (open).</li><li>Comparison operations for the <code>FPBits</code> class were added <a href=https://github.com/llvm/llvm-project/pull/144983>#144983</a>.</li></ul><table><thead><tr><th>Basic Math Function</th><th>PR</th></tr></thead><tbody><tr><td><code>fabsbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/148398>#148398</a></td></tr><tr><td><code>ceilbf16</code>, <code>floorbf16</code>, <code>roundbf16</code>, <code>roundevenbf16</code>, <code>truncbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/152352>#152352</a></td></tr><tr><td><code>bf16add</code>, <code>bf16addf</code>, <code>bf16addl</code>, <code>bf16addf128</code>, <code>bf16sub</code>, <code>bf16subf</code>, <code>bf16subl</code>, <code>bf16subf128</code></td><td><a href=https://github.com/llvm/llvm-project/pull/152774>#152774</a></td></tr><tr><td><code>fmaxbf16</code>, <code>fminbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/152782>#152782</a></td></tr><tr><td><code>bf16mul</code>, <code>bf16mulf</code>, <code>bf16mull</code>, <code>bf16mulf128</code></td><td><a href=https://github.com/llvm/llvm-project/pull/152847>#152847</a></td></tr><tr><td><code>fmaximumbf16</code>, <code>fmaximum_magbf16</code>, <code>fmaximum_mag_numbf16</code>, <code>fmaximum_numbf16</code>, <code>fminimumbf16</code>, <code>fminimum_magbf16</code>, <code>fminimum_mag_numbf16</code>, <code>fminimum_numbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/152881>#152881</a></td></tr><tr><td><code>bf16div</code>, <code>bf16divf</code>, <code>bf16divl</code>, <code>bf16divf128</code></td><td><a href=https://github.com/llvm/llvm-project/pull/153191>#153191</a></td></tr><tr><td><code>bf16fma</code>, <code>bf16fmaf</code>, <code>bf16fmal</code>, <code>bf16fmaf128</code></td><td><a href=https://github.com/llvm/llvm-project/pull/153231>#153231</a></td></tr><tr><td><code>llrintbf16</code>, <code>llroundbf16</code>, <code>lrintbf16</code>, <code>lroundbf16</code>, <code>nearbyintbf16</code>, <code>rintbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/153882>#153882</a></td></tr><tr><td><code>fromfpbf16</code>, <code>fromfpxbf16</code>, <code>ufromfpbf16</code>, <code>ufromfpxbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/153992>#153992</a></td></tr><tr><td><code>nextafterbf16</code>, <code>nextdownbf16</code>, <code>nexttowardbf16</code>, <code>nextupbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/153993>#153993</a></td></tr><tr><td><code>getpayloadbf16</code>, <code>setpayloadbf16</code>, <code>setpayloadsigbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/153994>#153994</a></td></tr><tr><td><code>nanbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/153995>#153995</a></td></tr><tr><td><code>frexpbf16</code>, <code>ilogbbf16</code>, <code>ldexpbf16</code>, <code>llogbbf16</code>, <code>logbbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/154427>#154427</a></td></tr><tr><td><code>modfbf16</code>, <code>remainderbf16</code>, <code>remquobf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/154652>#154652</a></td></tr><tr><td><code>canonicalizebf16</code>, <code>iscanonicalbf16</code>, <code>issignalingbf16</code>, <code>copysignbf16</code>, <code>fdimbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/155567>#155567</a></td></tr><tr><td><code>totalorderbf16</code>, <code>totalordermagbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/155568>#155568</a></td></tr><tr><td><code>scalbnbf16</code>, <code>scalblnbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/155569>#155569</a></td></tr><tr><td><code>fmodbf16</code></td><td><a href=https://github.com/llvm/llvm-project/pull/155575>#155575</a></td></tr></tbody></table><p>The implementation status can be viewed at the libc <code>math.h</code> header implementation <a href=https://libc.llvm.org/headers/math/index.html>status page</a>, which is updated regularly.</p><h2 id=what-was-not-done>What was not done</h2><ul><li>The implementation used a generic approach and did not rely on the <code>__bf16</code> compiler intrinsic, as it is not available in all compilers versions. Our goal is to ensure that the type is supported by all compilers and versions supported by <a href=https://libc.llvm.org/compiler_support.html>LLVM libc</a>.</li><li>Hardware optimizations provided by Intel&rsquo;s <a href="https://www.intel.com/content/www/us/en/docs/intrinsics-guide/index.html#avx512techs=AVX512_BF16">AVX-512_BF16</a> were not utilized. These instructions only support round-to-nearest-even mode, always flush output denormals to zero, and treat input denormals as zero, which does not align with our goal. See <a href=https://www.felixcloutier.com/x86/vcvtne2ps2bf16#description>VCVTNE2PS2BF16 instruction description</a>.</li><li>ARMv9 <a href=https://developer.arm.com/documentation/ddi0602/2021-12/SVE-Instructions/>SVE instructions</a> were not utilized, as they are relatively new and not yet widely supported.</li><li>Not all higher math functions were implemented due to time constraints.</li></ul><h2 id=future-work>Future Work</h2><ul><li>Implement the remaining higher math functions.</li><li>Perform performance comparisons with other libc implementations once their <code>bfloat16</code> support is available and also with the <a href=https://core-math.gitlabpages.inria.fr/>CORE-MATH</a> project.</li><li>Update the test suite when the <code>mpfr_get_bfloat16</code> function becomes available.</li></ul><h2 id=acknowledgements>Acknowledgements</h2><p>I would like to thank my mentors, Tue Ly and Nicolas Celik, for their invaluable guidance and support throughout this project. The project wouldn&rsquo;t have been possible without them. I am also grateful to the LLVM Foundation and the GSoC admins for giving me this opportunity.</p></article><section class=post-nav><ul><li><a href=https://blog.llvm.org/posts/2025-gsoc-clang-doc/><i class="fa fa-chevron-circle-left"></i> GSoC 2025: Improving Core Clang-Doc Functionality</a></li><li><a href=https://blog.llvm.org/posts/2025-08-gsoc-modules-driver/>GSoC 2025 - Support simple C++20 modules use from the Clang driver without a build system <i class="fa fa-chevron-circle-right"></i></a></li></ul></section></main><footer><ul><li><h6>llvm.org |
Rendered by <a href=https://gohugo.io title=Hugo>Hugo</a> |
<a href=https://blog.llvm.org/index.xml>Subscribe</a></h6></li></ul></footer></div><script src=https://blog.llvm.org/js/scripts.js></script></body></html>