---
author: Unknown
blogger_id: tag:blogger.com,1999:blog-6088150582281556517.post-6451981026030637556
blogger_orig_url: http://blog.llvm.org/2014/02/llvm-weekly-8-feb-24th-2014.html
url: "2014/02/llvm-weekly-8-feb-24th-2014.html"
date: "2014-02-24T06:05:00Z"
modified_time: "2014-04-06T10:30:00.880-07:00"
tags: ["llvmweekly"]
title: 'LLVM Weekly - #8, Feb 24th 2014'
aliases:
 - /2014/02/llvm-weekly-8-feb-24th-2014.html
---

<p>Welcome to the eighth issue of LLVM Weekly, a weekly newsletter (published  every Monday) covering developments in LLVM, Clang, and related projects. LLVM Weekly is brought to you by <a href="http://asbradbury.org">Alex Bradbury</a>. Subscribe to future issues at <a href="http://llvmweekly.org">http://llvmweekly.org</a> and pass it on to anyone  else you think may be interested. Please send any tips or feedback to  <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#97;&#115;&#98;&#64;&#97;&#115;&#98;&#114;&#97;&#100;&#98;&#117;&#114;&#121;&#46;&#111;&#114;&#103;">&#97;&#115;&#98;&#64;&#97;&#115;&#98;&#114;&#97;&#100;&#98;&#117;&#114;&#121;&#46;&#111;&#114;&#103;</a>, or  <a href="https://twitter.com/llvmweekly">@llvmweekly</a> or <a href="https://twitter.com/asbradbury">@asbradbury</a> on Twitter.</p><p>I'll be at the <a href="http://www.raspberrypi.org/archives/6074">Raspberry Jamboree</a>  at the end of the week, so if you're going as well be sure to say hi.</p> <p>The canonical home for this issue <a href="http://llvmweekly.org/issue/8">can be found here at llvmweekly.org</a>. </p> <a name='more'></a> <h3>News and articles from around the web</h3><ul><li><p>As a followup to the proposal that Philip Reames posted last week, where he  described plans for contributing precise garbage collection support to LLVM,  he has <a href="http://www.philipreames.com/Blog/2014/02/21/why-not-use-gcroot/">written a blog post about why the llvm.gcroot intrinsic is  insufficient for this  purpose</a>. A  followup post is promised describing the approach they've decided to take. The  article is is written so as to be accessible to those who may not be familiar  with GC implementation. He also raises some interesting issues with gcroot,  even when using it for a non-relocating collector.</p></li><li><p>Some may remember the <a href="http://dagger.repzret.org/">Dagger project</a> for  decompilation of programs to LLVM IR from EuroLLVM 2013  (<a href="http://llvm.org/devmtg/2013-04/bougacha-slides.pdf">slides</a>). The promised  source code release didn't happen, but the developers have <a href="http://dagger.repzret.org/update-feb-2014/">posted an  update</a> detailing what they've  been up to. There have been a lot of design changes, and some of the work has  been submitted upstream as patches to LLVM MC. "At this point we don't really  have a schedule; whenever we feel a patch is ready to go, we submit it to the  community. The goal being, once we're done, our work becomes a full part of  LLVM, where we and all contributors can continue to advance it!"</p></li><li><p>Tam√°s Szelei has written up a <a href="http://szelei.me/code-generator/">useful guide to implementing a code generator  with libclang and Python</a>.</p></li><li><p>The Emscripten project is <a href="https://groups.google.com/forum/#!topic/emscripten-discuss/mZMkX3uBG4s">getting ready to use its 'fastcomp' LLVM backend  by  default</a>. Previously they had a series of passes written in Javascript to convert from  LLVM IR to Javascript, but this is now implemented as a C++ LLVM backend. See  <a href="https://github.com/kripken/emscripten/wiki/LLVM-Backend">their wiki</a> for more  info.</p></li><li><p>Agner has <a href="http://agner.org/optimize/blog/read.php?i=311#311">updated his popular optimisation  manuals</a> to include test  results for AMD Steamroller processors, as well as adding some more AVX-512  information.</p></li><li><p>The <a href="http://dwarfstd.org">DWARF Debugging Information Format Committee</a> are  welcoming comments, suggestions or proposals for changes to DWARF <a href="http://article.gmane.org/gmane.comp.compilers.clang.devel/35175/">until March  31st</a>. Although DWARF Version 5 is 'nearing completion', it seems that no drafts have  been published so you'll have to base your comments on DWARF 4. Do drop me a  note if you know otherwise.</p></li><li><p>There have been <a href="http://sylvestre.ledru.info/blog/2014/02/22/some-updates-on-llvm-org">several  updates</a>  to <a href="http://llvm.org/apt/">http://llvm.org/apt/</a>. The upcoming Ubuntu 14.04 is  now a supported distribution, and additionally both the stable and development  versions of LLVM/Clang are built and can be installed side-by-side.</p></li></ul><h3>On the mailing lists</h3><ul><li><p>Renato Golin <a href="http://article.gmane.org/gmane.comp.compilers.clang.devel/35229">reminds  us</a> that  although work is underway to update all buildbots to support C++11, the switch  to use <code>-std=c++11</code> has not yet been flipped, so you'll have to hold off on  using C++11 features in LLVM/Clang patches for just a little longer.</p></li><li><p>Saleem Abulrasool <a href="http://article.gmane.org/gmane.comp.compilers.llvm.devel/70584">points to an issue running recent Clang on the Linux  kernel</a>  related to the integrated assembler. As regular readers will know, the  behaviour was recently changed so that for backends which have an integrated  assembler, any inline assembly will be validated by it during compilation,  even when compiling with <code>-S</code> (i.e. outputting assembly). The problem is that  the Linux kernel is purposely including invalid assembly in some cases when  outputting assembler files. Early responses are in favour of keeping current  behaviour, people who are doing weird and wacky things can just use the  <code>-no-integrated-as</code> switch.</p></li><li><p>In response to the earlier discussion about unwind behaviour in LLVM/Clang,  Logan Chien has <a href="http://article.gmane.org/gmane.comp.compilers.llvm.devel/70461">posted a detailed description of the problems he  sees</a>.</p></li><li><p>Kevin Qin writes <a href="http://article.gmane.org/gmane.comp.compilers.llvm.devel/70511">asking about adding register allocation  constraints</a>. Often the mailing list threads which get highlighted in LLVM Weekly are about  particularly hairy problems that don't currently have a good solution. I'm  happy to see this problem has a simple solution though, as Tim Northover and  Quentin Colombet point out the <code>@earlyclobber</code> constraint can be used to  ensure the output register allocated is different to the input registers.</p></li><li><p>While working on changes to CodeGenPrepare, Quentin Combet noted his patch  would introduce a dependency from libLLVMScalarOpts (where CodeGenPrepare  currently lives) to libLLVMCodeGen. He <a href="http://article.gmane.org/gmane.comp.compilers.llvm.devel/70528">writes to the  list</a> asking  for views on how to solve this problem. The forming consensus seems to be that  it should just be moved to CodeGen. Potentially, any IR pass that depends  directly on TargetLowering should be moved also. The move to CodeGenPrepare to  lib/CodeGen has now <a href="http://reviews.llvm.org/rL201912">been  committed</a>.</p></li><li><p>Per Viberg is <a href="http://article.gmane.org/gmane.comp.compilers.clang.devel/35185">soliciting  comments</a> on his  design draft for improving the detection of uninitialized arguments.</p></li></ul><h3>LLVM commits</h3><ul><li><p>The llvm-profdata tool was introduced. This tool will merge profile data  generated by PGO instrumentation in Clang, though may later pick up more  functionality. <a href="http://reviews.llvm.org/rL201535">r201535</a>.</p></li><li><p>In a long overdue cleanup, various member variables were renamed from TD to  DL to match the renaming of TargetData to DataLayout. <a href="http://reviews.llvm.org/rL201581">r201581</a>,  <a href="http://reviews.llvm.org/rL201827">r201827</a>,  <a href="http://reviews.llvm.org/rL201833">r201833</a>. Additionally, DebugLoc  variables which were named DL have now been renamed to DbgLoc so as not to be  confused with DataLayout. <a href="http://reviews.llvm.org/rL201606">r201606</a>.</p></li><li><p>MCAsmParser now supports required parameters in macros, increasing GNU  assembler compatibility. <a href="http://reviews.llvm.org/rL201630">r201630</a>.</p></li><li><p>A new TargetLowering hook, <code>isVectorShiftByScalarCheap</code> was added to  indicate whether it's significantly cheaper to shift a vector by a scalar  rather than by another vector with different values for different lanes. This  is used by the new <code>OptimizeShuffleVectorInst</code> in CodeGenPrepare which tries  to sink shufflevector instructions down to the basic block they're used so  CodeGen can determine if the right hand of a shift is really a scalar. <a href="http://reviews.llvm.org/rL201655">r201655</a>.</p></li><li><p>Private linkage is now properly supported for MachO. <a href="http://reviews.llvm.org/rL201700">r201700</a>.</p></li><li><p>getNameWithPrefix and getSymbol were moved from TargetLowering to  TargetMachine, which removes the dependency from Target to CodeGen. <a href="http://reviews.llvm.org/rL201711">r201711</a>.</p></li></ul><h3>Clang commits</h3><ul><li><p>The PGO instrumentation will now compute counts in a separate AST traversal. The reasons for and advantages of this change are documented in detail in the  commit message. <a href="http://reviews.llvm.org/rL201528">r201528</a>.</p></li><li><p>Some initial work was committed on documenting available attributes in  Clang. Attribute authors are encouraged to submit missing documentation (the  method of documentation is described in the addition to the  InternalManual.rst). <a href="http://reviews.llvm.org/rL201515">r201515</a>.</p></li><li><p>The IdenticalExprChecker has been extended to check the two branches of an  if as well as logical and bitwise expressions. For those not familiar, this  checker tries to warn about the unintended use of identical expressions. <a href="http://reviews.llvm.org/rL201701">r201701</a>,  <a href="http://reviews.llvm.org/rL201702">r201702</a>.</p></li><li><p>CGRecordLayoutBuilder has been completely rewritten to remove cruft,  simplify the implementation, and to work in one pass. <a href="http://reviews.llvm.org/rL201907">r201907</a>.</p></li><li><p>The CastSizeChecker was taught how to correctly deal with flexible array  members. <a href="http://reviews.llvm.org/rL201583">r201583</a>.</p></li><li><p>A number of thread-safety attributes have been renamed (with their old name  silently deprecated). e.g. <code>lockable</code> is now <code>capability</code>,  <code>exclusive_locks_required</code> is now <code>requires_capability</code>. <a href="http://reviews.llvm.org/rL201585">r201585</a>. Additionally, the  documentation was updated and greatly expanded. <a href="http://reviews.llvm.org/rL201598">r201598</a>.</p></li><li><p>Initial virtual file system support <a href="http://article.gmane.org/gmane.comp.compilers.clang.devel/34941">discussed previously on the mailing  list</a> has landed. <a href="http://reviews.llvm.org/rL201618">r201618</a>,  <a href="http://reviews.llvm.org/rL201635">r201635</a>.</p></li><li><p>The vcvtX intrinsics were added for v8 ARM as opposed to only being  recognised when targeting AArch64. <a href="http://reviews.llvm.org/rL201661">r201661</a>.</p></li><li><p>The hard-float ARM EABI (often known as gnueabihf) is now supported for  FreeBSD. <a href="http://reviews.llvm.org/rL201662">r201662</a>.</p></li><li><p>Clang will now provide <code>max_align_t</code> in C11 and C++11 modes. Note the  complaint in the commit message though that <code>max_align_t</code> as defined is not  'good' or 'useful'. <a href="http://reviews.llvm.org/rL201729">r201729</a>.</p></li><li><p>Again, there were a number of commits related to increasing compatibility  with the MS ABI. None of them immediately leaped out at me as worth  highlighting individually, so I recommend you have a flick through last weeks  commits if you're particularly interested.</p></li></ul><h3>Other project commits</h3><ul><li><p>Rudimentary support for a standalone compiler-rt build system was added,  which will allow the compiler-rt libraries to be built seperately from  LLVM/Clang. <a href="http://reviews.llvm.org/rL201647">r201647</a>,  <a href="http://reviews.llvm.org/rL201656">r201656</a>.</p></li><li><p>Assembly functions for AddressSanitizer on x86/amd64 were added. <a href="http://reviews.llvm.org/rL201650">r201650</a>.</p></li><li><p>LLDB gained a hardware watchpoint implementation for FreeBSD  <a href="http://reviews.llvm.org/rL201706">r201706</a>.</p></li><li><p>Polly gained support for polyhedral dead code elimination. <a href="http://reviews.llvm.org/rL201817">r201817</a>.</p></li><li><p>A patch was added to lldb to provide initial support for the Hexagon DSP. <a href="http://reviews.llvm.org/rL201655">r201665</a>.</p></li></ul>
